language: python
sudo: true
python:
  #- "2.7"
  - "3.5"

before_install:
  - sudo apt-get update
  - sudo apt-get install -qq python2.7 python-pip

install:
  - pip3 install -r requirements.txt
  - pip2.7 install -v --user gi
  - export PYTHONPATH=$PYTHONPATH:/home/travis/.local/lib/python2.7/site-packages/
  - echo $PYTHONPATH
  - pip3 install --upgrade -r test/requirements.txt
  - ln -s `pwd` $(dirname `which python2.7`)/../lib/python2.7/site-packages/gi

script:
  # so to help eventual debug: knowing what exact versions are in use can be rather useful.
  - pip2.7 freeze
  - pip3 freeze
  # Code static analysis
  # - pep8 --max-line-length=100 --exclude='*.pyc, *.cfg, *.log' --ignore='E402' alignak_app/*
  #- pylint --rcfile=.pylintrc alignak_webui/
  # No pep257 currently (Code doc compliance)
  # - pep257 --select=D300 alignak_webui
  # Code dynamic analysis
  # - cd test
  # - coverage erase
  - nosetests -xv --nologcapture --with-coverage --cover-package=alignak_app test/test_application.py
  # - coverage combine
  # - coverage report -m
  # - cd ..

# specific call to launch coverage data into coveralls.io
# after_success:
  # to get coverage data with relative paths and not absolute we have to
  # execute coveralls from the base directory of the project,
  # so we need to move the .coverage file here :
  # mv test/.coverage . && coveralls --rcfile=test/.coveragerc -v
  #mv test/.coverage . && coveralls -v
